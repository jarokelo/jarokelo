var ReportsOnMap=function(){"use strict";function t(){$("#report-search-form").submit()}function e(){["fullscreenchange","mozfullscreenchange","webkitfullscreenchange","msfullscreenchange"].forEach(function(t){document.addEventListener(t,function(){a.resize()})})}function o(){var t=$("#map-report-list");0===t.length||$(window).width()<1200||(t.css("overflow-y","scroll"),t.height($(window).height()-300))}function n(){if(null==window.reportsOnMapInitData)return void setTimeout(n,500);if(c(),s(),$("#map").html()){o(),e();var t=window.reportsOnMapInitData.center;a=new mapboxgl.Map({container:"map",style:"mapbox://styles/mapbox/streets-v11",center:[t.lng,t.lat],zoom:17}),a.addControl(new mapboxgl.FullscreenControl),l(),m(),d(),$(".marker").on("click",function(){document.location.href=$(this).data("href")}),a.addControl(new mapboxgl.NavigationControl,"bottom-right")}}var a,r=[];mapboxgl.accessToken=window.mapboxToken;var i=function(t){a.setZoom(16),a.panTo(r[t].marker.getLngLat())},c=function(){$(".map-search-form-location").each(function(t,e){new google.maps.places.Autocomplete(e,{types:["address"],componentRestrictions:{country:"hu"}})})},s=function(){var e=$("#map-search-form-location-mobile");$(".button-show_me-mobile").on("click",function(){navigator.geolocation&&navigator.geolocation.getCurrentPosition(function(o){var n=o.coords.longitude,a=o.coords.latitude,r=new google.maps.Geocoder;r.geocode({location:{lng:n,lat:a}},function(o,n){n===google.maps.GeocoderStatus.OK&&o[0]&&o[0].formatted_address&&(e.val(o[0].formatted_address),t())})})}),e.on("change",function(){t()}),$(".button-show_me-mobile--clear").click(function(o){o.preventDefault(),e.val(""),t()})},l=function(){$(".reportsonmap").find(".card").click(function(t){var e=$(t.target||t.srcElement||t.originalTarget);e.attr("href")||(t.preventDefault(),i($(this).data("id")))})},d=function(){var t=new mapboxgl.LngLatBounds;r.forEach(function(e){t.extend(e.marker.getLngLat())}),a.fitBounds(t,{padding:100})},m=function(){$(".reportsonmap").find(".card").each(function(){var t=$(this),e=t.find(".badge").css("background-color"),o=t.data("id");if(r[o]={},site.Helper.isIE())n.src="https://maps.gstatic.com/mapfiles/api-3/images/autocomplete-icons_hdpi.png",n.style.backgroundColor=e,n.style.width="22px",n.style.height="42px";else{var n=document.createElement("div"),i=document.createElementNS("http://www.w3.org/2000/svg","svg"),c=document.createElementNS("http://www.w3.org/2000/svg","use");c.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",window.STATIC_ASSETS_PATH+"/images/icons.svg#icon-magnify"),n.appendChild(i),i.appendChild(c),i.setAttribute("fill",e),i.style.width="32px",i.style.height="32px",i.setAttribute("class","marker")}n.title=t.find("h3").text(),i.dataset.href=t.find("h3").find("a").attr("href"),r[o].marker=new mapboxgl.Marker(n,{}).setLngLat([parseFloat(t.attr("data-lng")),parseFloat(t.attr("data-lat"))]),r[o].marker.addTo(a)})};return{initMap:n}}();